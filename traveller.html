<div class="main">
  <div class="stats section">
    <div class="stat-block">
      <div><label>STRENGTH</label></div>
      <div><input name="attr_strength" type="number" value="0"></div>
      <div><span name="attr_strength_bonus"></span></div>
      <div><button name="roll_strength" type="roll" value="&{template:default} {{name=Strength}} {{Result=[[2d6+(@{strength_bonus})]]}}"></button></div>
    </div>
    <div class="stat-block">
      <div><label>STRENGTH</label></div>
      <div><input name="attr_strength" type="number" value="0"></div>
      <div><span name="attr_strength_bonus"></span></div>
      <div><button name="roll_strength" type="roll" value="&{template:default} {{name=Strength}} {{Result=[[2d6+(@{strength_bonus})]]}}"></button></div>
    </div>
    <div class="stat-block">
      <div><label>STRENGTH</label></div>
      <div><input name="attr_strength" type="number" value="0"></div>
      <div><span name="attr_strength_bonus"></span></div>
      <div><button name="roll_strength" type="roll" value="&{template:default} {{name=Strength}} {{Result=[[2d6+(@{strength_bonus})]]}}"></button></div>
    </div>
    </div>
  </div>   
</div>

<!-- ---------------------------SHEET WORKERS----------------- -->

<script type="text/worker">
  const stats = ["strength"];
  stats.forEach(stat => {
      on(`change:${stat}`, () => {
          getAttrs([stat], values => {
              const stat_base = values[stat];
              console.log(stat_base);
              let stat_bonus = -5;
              if (stat_base >= 15) stat_bonus = "+3";
              else if (stat_base >= 12) stat_bonus = "+2";
              else if (stat_base >= 9) stat_bonus = "+1";
              else if (stat_base >= 6) stat_bonus = "0";
              else if (stat_base >= 3) stat_bonus = "-1";
              else if (stat_base >= 1) stat_bonus = "-2";
              else stat_bonus = "-3";
              
              setAttrs({
                  [`${stat}_bonus`]: stat_bonus
              });
          });
      });
  });
  
  </script>
